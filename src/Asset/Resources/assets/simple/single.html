<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <title>AbsoluteAdmin - A Responsive Boostrap 3 Admin Dashboard</title>
    <meta name="keywords" content="Bootstrap 3 Admin Dashboard Template Theme" />
    <meta name="description" content="AdminDesigns - Bootstrap 3 Admin Dashboard Theme">
    <meta name="author" content="AdminDesigns">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <!-- <link href="css/bootstrap.min.css" rel="stylesheet"> -- Local Version -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/theme.css" rel="stylesheet">
    <link rel="stylesheet" href="fonts/font-awesome/css/font-awesome.css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

<!-- Navigation -->
<nav class="navbar navbar-default navbar-shrink navbar-shrink-scroll">
    <!-- Topbar Nav (hidden) -->
    <div class="topbar-nav clearfix">
        <div class="container">
            <ul class="topbar-left list-unstyled list-inline">
                <li> <span class="fa fa-phone"></span> 123-456-7890 </li>
                <li> <span class="fa fa-envelope"></span> info@yourdomain.com </li>
            </ul>
            <ul class="topbar-right list-unstyled list-inline topbar-social">
                <li> <a href="#"> <span class="fa fa-facebook"></span> </a></li>
                <li> <a href="#"> <span class="fa fa-twitter"></span> </a></li>
                <li> <a href="#"> <span class="fa fa-google-plus"></span> </a></li>
                <li> <a href="#"> <span class="fa fa-dribbble"></span> </a></li>
                <li> <a href="#"> <span class="fa fa-instagram"></span> </a></li>
            </ul>

        </div>
    </div>

    <div class="container" style="max-width: 1050px;">

        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" href="#page-top">Fast-D</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="active">
                    <a href="#page-top">文档</a>
                </li>
                <li>
                    <a class="page-scroll" href="#services">更新</a>
                </li>
                <li>
                    <a class="page-scroll" href="#features-flat">教程</a>
                </li>
                <li>
                    <a class="page-scroll" href="#portfolio">博客</a>
                </li>
                <li>
                    <a class="page-scroll" href="#footer">关于</a>
                </li>
                <li>
                    <a class="page-scroll" target="_blank" href="https://github.com/JanHuang/fastD"><i class="fa fa-github" style="font-size: 20px;"></i></a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

<section id="content" >
    <section class="container">
        <div class="row">
            <div class="col-md-9">


                <article>
                    <h1>PHP-DI 5.0 released</h1>

                    <p class="article-information">
                        Posted by Matthieu Napoli on June 10th 2015
                    </p>

                    <p>I am very excited to announce that, after 8 months of work, PHP-DI 5.0 is released.</p>
                    <p>Note: <strong>if you have never heard of PHP-DI before, I recommend you visit <a href="../">the home page</a></strong> to get an overview of what PHP-DI can do for you.</p>
                    <p>This is a new major version that comes with:</p>
                    <ul>
                        <li>minor backward compatibility breaks (nothing to get too alarmed about)</li>
                        <li>API and syntax simplifications (aka syntactic sugar)</li>
                        <li>new major features for modular applications (aka bundles, modules, plugins, …)</li>
                        <li>performance improvements (thanks <a href="https://blackfire.io/">Blackfire</a>) and a much lighter package (from 10 to 3 Composer dependencies, less files, …)</li>
                        <li>a new website, logo and rewritten documentation</li>
                        <li>a <a href="../doc/frameworks/silex.html">Silex integration</a></li>
                        <li>a <a href="https://github.com/PHP-DI/demo">demo application</a></li>
                    </ul>
                    <p>But the best news of all is that this new major version wasn't produced out of thin air: it has been used in <a href="https://piwik.org/">Piwik</a> and developed as a rolling release (i.e. always stable and deployed) to test and evaluate new features hands on. Because of that, PHP-DI 5 has been in production since January 2015. <strong>More that 100 000 Piwik installs in the wild are running PHP-DI 5 already!</strong></p>
                    <p>So let's start and have a look at what's new.</p>
                    <h2 id="a-new-organization">A new organization</h2>
                    <p>PHP-DI has been moved from my own GitHub account to a separate <a href="https://github.com/PHP-DI">PHP-DI</a> organization on GitHub. The project can now be found at <a href="https://github.com/PHP-DI/PHP-DI">github.com/PHP-DI/PHP-DI</a>. Thankfully GitHub sets up redirects from the old URL so nothing bad should happen here.</p>
                    <p>The Composer package has also changed name: from <code>mnapoli/php-di</code> to <a href="https://packagist.org/packages/php-di/php-di"><code>php-di/php-di</code></a>.</p>
                    <p>While upgrading, you should change your <code>composer.json</code> to require <code>php-di/php-di</code>. Rest assured that you can still install older versions with <code>mnapoli/php-di</code> (backward compatibility is kept).</p>
                    <h2 id="bc-breaks">BC breaks</h2>
                    <p>PHP-DI 5 doesn't break major features so you will not have a lot of work to upgrade. Here are the main changes:</p>
                    <ul>
                        <li>PHP 5.3 is no longer supported (5.4 or above is required)</li>
                        <li>annotations are now disabled by default</li>
                        <li>some optional dependencies are not installed by default anymore (ProxyManager for lazy injection, doctrine/annotations, doctrine/cache) -&gt; 7 less Composer dependencies</li>
                        <li><code>DI\link()</code> is deprecated in favor of a new <code>DI\get()</code> (but still works, so not really a BC break)</li>
                    </ul>
                    <p>The complete list of changes are detailed extensively in the <a href="../doc/migration/5.0.html">migration guide to 5.0</a>.</p>
                    <h2 id="api-simplifications-aka-syntactic-sugar">API simplifications, aka syntactic sugar</h2>
                    <p>PHP-DI wants to be the DI container <em>for humans</em>, simplicity of use is one of its most important feature. To improve that even more, a few things have been added.</p>
                    <p>Most of these changes have been explained in the previous blog article: <a href="14-php-di-5-syntaxic-sugar.html">Syntactic sugar in PHP-DI 5</a>. Here is a reminder of the most important improvements:</p>
<pre><code class="language-php hljs"><span class="hljs-preprocessor">&lt;?php</span>

    <span class="hljs-keyword">use</span> ...;
    <span class="hljs-keyword">use</span> <span class="hljs-title">function</span> ...; <span class="hljs-comment">// PHP 5.6 example</span>

    <span class="hljs-keyword">return</span> [
    <span class="hljs-string">'path.root'</span> =&gt; <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/..'</span>,

    <span class="hljs-comment">// new DI\string() helper to write string expressions</span>
    <span class="hljs-string">'path.cache'</span> =&gt; string(<span class="hljs-string">'{path.root}/var/cache'</span>),

    <span class="hljs-comment">// DI\factory() is now optional when using closures</span>
    PdfGenerator::class =&gt; <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> ...;
    },

    <span class="hljs-comment">// array of services, yay!</span>
    <span class="hljs-string">'notification.handlers'</span> =&gt; [
    get(EmailHandler::class),
    get(TextHandler::class),
    get(PushHandler::class),
    ],

    <span class="hljs-comment">// nest definitions in other definitions!</span>
    Cache::class =&gt; object(JsonFileCache::class)
    -&gt;constructor(string(<span class="hljs-string">'{path.cache}/cache.json'</span>)),
    ];</code></pre>
                    <h2 id="features-for-modular-applications">Features for modular applications</h2>
                    <p>The main motivation behind PHP-DI 5 was to improve support for scenarios involving several configuration files. The best illustration for this are application built using modules/bundles/plugins, which is exactly what was needed for Piwik and its plugin system.</p>
                    <h3 id="lists">Lists</h3>
                    <p>Playing with lists is one of the most important feature. It involves defining array of services as well as adding new items to an existing array.</p>
                    <p>Let's illustrate that with an example: your application can support many "authentication providers". By default, you can sign up to the application and create an account which will be stored in a database (using an email and a password):</p>
<pre><code class="language-php hljs"><span class="hljs-comment">// application config file</span>
    <span class="hljs-keyword">return</span> [
    <span class="hljs-string">'auth.providers'</span> =&gt; [
    get(DatabaseAuthProvider::class),
    ],
    ];</code></pre>
                    <p>However you can have modules that can provide new authentication systems:</p>
<pre><code class="language-php hljs"><span class="hljs-comment">// Facebook login module</span>
    <span class="hljs-keyword">return</span> [
    <span class="hljs-string">'auth.providers'</span> =&gt; DI\add([
    get(FacebookAuthProvider::class),
    ]),
    ];</code></pre>
<pre><code class="language-php hljs"><span class="hljs-comment">// Twitter login module</span>
    <span class="hljs-keyword">return</span> [
    <span class="hljs-string">'auth.providers'</span> =&gt; DI\add([
    get(TwitterAuthProvider::class),
    ]),
    ];</code></pre>
                    <p>Those modules can be registered by simply adding the configuration files:</p>
<pre><code class="language-php hljs"><span class="hljs-variable">$builder</span> = <span class="hljs-keyword">new</span> ContainerBuilder();

    <span class="hljs-variable">$builder</span>-&gt;addDefinitions(<span class="hljs-string">'app/config.php'</span>);
    <span class="hljs-variable">$builder</span>-&gt;addDefinitions(<span class="hljs-string">'src/FacebookModule/config.php'</span>);
    <span class="hljs-variable">$builder</span>-&gt;addDefinitions(<span class="hljs-string">'src/TwitterModule/config.php'</span>);</code></pre>
                    <p>As a result getting the <code>auth.providers</code> list will return the 3 items merged:</p>
<pre><code class="language-php hljs">[
    get(DatabaseAuthProvider::class),
    get(FacebookAuthProvider::class),
    get(TwitterAuthProvider::class),
    ]</code></pre>
                    <p>For those familiar with Symfony, the same result can be achieved using <a href="http://symfony.com/doc/current/components/dependency_injection/tags.html">tags</a>. The approach chosen for PHP-DI is a little different for multiple reasons:</p>
                    <ul>
                        <li>adding an item to an array is more similar to what we do in vanilla PHP</li>
                        <li>tags require to write <a href="http://symfony.com/doc/current/components/dependency_injection/tags.html#create-a-compilerpass">compiler passes</a> which are verbose and not trivial</li>
                        <li>tags don't work if the container isn't compiled</li>
                    </ul>
                    <p>While tags offer an approach with more freedom, manipulating lists instead of tags is simpler and feels more natural to use.</p>
                    <h3 id="decorating-a-previous-entry">Decorating a previous entry</h3>
                    <p>A new <code>DI\decorate()</code> helper was added, allowing to decorate a previous entry using a closure. A common scenario for using this is to override object using the <a href="http://en.wikipedia.org/wiki/Decorator_pattern">decorator pattern</a>.</p>
                    <p>Here is an example where a module replaces the default "Product DAO" for by decorating it with a cache wrapper:</p>
<pre><code class="language-php hljs"><span class="hljs-comment">// application config</span>
    ProductDaoInterface::class =&gt; DI\object(ProductDaoMySQL::class)</code></pre>
<pre><code class="language-php hljs"><span class="hljs-comment">// module config</span>
    ProductDaoInterface::class =&gt; DI\decorate(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$previous</span>, ContainerInterface <span class="hljs-variable">$c</span>)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductDaoCached(<span class="hljs-variable">$previous</span>);
    })</code></pre>
                    <p>The first argument of the closure is the previous object (the one we decorate), the second argument is the container.</p>
                    <p>The example above is equivalent to:</p>
                    <pre><code class="language-php hljs"><span class="hljs-variable">$dao</span> = <span class="hljs-keyword">new</span> ProductDaoCached(<span class="hljs-keyword">new</span> ProductDaoMySQL());</code></pre>
                    <h2 id="silex-integration">Silex integration</h2>
                    <p>A new framework integration comes with this new version: the <a href="http://silex.sensiolabs.org/">Silex</a> micro-framework. If you are interested to learn about it, head over to <a href="../doc/frameworks/silex.html">the documentation</a>.</p>
                    <h2 id="wrapping-it-up">Wrapping it up</h2>
                    <p>I hope you will like this new version, as well as the new website. If you want the complete list of changes, head over to <a href="../change-log.html">the change log</a>.</p>
                    <p>If you are migrating from a 4.x version, have a look at the detailed <a href="../doc/migration/5.0.html">migration guide</a>.</p>
                    <p>If something isn't right in the package or the documentation, please <a href="https://github.com/PHP-DI/PHP-DI/issues/new">open an issue</a>. You can also find support in the <a href="https://gitter.im/PHP-DI/PHP-DI">Gitter chatroom</a>.</p>
                </article>

                <h3>
                    Comments
                </h3>
                <div id="disqus_thread"><iframe id="dsq-2" data-disqus-uid="2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="http://disqus.com/embed/comments/?base=default&amp;version=5348da30381623a1fea37914913b2a94&amp;f=phpdi&amp;t_u=http%3A%2F%2Fphp-di.org%2Fnews%2F15-php-di-5-0-released.html&amp;t_d=PHP-DI%205.0%20released%20-%20The%20Dependency%20Injection%20Container%20for%20humans&amp;t_t=PHP-DI%205.0%20released%20-%20The%20Dependency%20Injection%20Container%20for%20humans&amp;s_o=default#2" style="width: 100% !important; border: none !important; overflow: hidden !important; height: 321px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
                <noscript>
                    Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;
                </noscript>


            </div>

            <div class="col-md-3">
                <h3>
                    All posts
                </h3>

                <ul class="all-posts list-unstyled">
                    <li>
                        <a href="http://php-di.org/news/15-php-di-5-0-released.html">PHP-DI 5.0 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/14-php-di-5-syntaxic-sugar.html">Syntactic sugar in PHP-DI 5</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/13-php-di-4-4-released.html">PHP-DI 4.4 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/12-php-di-is-better-with-php-5-6.html">PHP 5.6 is out and PHP-DI just got better</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/11-php-di-4-3-released.html">PHP-DI 4.3 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/10-php-di-4-2-released.html">PHP-DI 4.2 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/09-php-di-4-1-released.html">PHP-DI 4.1 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/08-10000-installs.html">10.000 installs!</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/07-php-di-4-0-released.html">PHP-DI 4.0 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/06-php-di-4-0-new-definitions.html">What will change in PHP-DI 4: the new definition format</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/05-php-di-3-5.html">PHP-DI 3.5 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/04-php-di-3-4.html">PHP-DI 3.4 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/03-php-di-3-3.html">PHP-DI 3.3 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/02-php-di-3-2.html">PHP-DI 3.2 released</a>
                    </li>
                    <li>
                        <a href="http://php-di.org/news/01-php-di-3-1.html">PHP-DI 3.1 released</a>
                    </li>
                </ul>
            </div>

        </div>
    </section>
    <div class="clearfix"></div>
</section>
<footer id="footer">
    <div class="container mw850">
        <div class="row">
            <div class="col-md-6 text-left">
                <span class="copyright text-muted">Copyright &copy; <b>2015</b> </span>
            </div>
            <div class="col-md-6 text-right">
                <ul class="list-inline social-buttons">
                    <li><a target="_blank" href="https://github.com/JanHuang/fastD"><i class="fa fa-github"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<!-- <script src="js/vendor/jquery.js"></script> -- Local Version -->
<script src="js/vendor/jquery.js"></script>
<!-- Bootstrap Core JavaScript -->
<!-- <script src="js/vendor/bootstrap.min.js"></script> -- Local Version -->
<script src="js/vendor/bootstrap.min.js"></script>
</body>
</html>